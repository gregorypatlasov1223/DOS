Turbo Assembler	 Version 4.1	    02/17/26 18:54:20	    Page 1
my_frame.asm



      1	0000			     .model tiny
      2
      3	      =0028		     x_offset				= 20d*2d
      4	      =00A0		     length_of_terminal_string		= 80d*2h	  ; 160	bytes per row
      5	      =0028		     length_of_horizontal_part_of_frame	= 40d
      6
      7	0000			     .code
      8				     org 100h
      9
     10	      =B800		     VIDEOSEG equ 0B800h
     11
     12	0100			     start:
     13	0100  B8 B800				     mov ax, VIDEOSEG
     14	0103  8E C0				     mov es, ax
     15
     16	0105  BE 0010				     mov si, 10h				; skip 16 lines	(0..15), start at   +
     17				     line 16
     18	0108  B9 0028				     mov cx, length_of_horizontal_part_of_frame
     19	010B  BF 0005				     mov di, 5d					; number of inner rows
     20
     21	010E  E8 004F				     call CalculateCoordinates
     22	0111  E8 007C				     call PrintHorizontalPartOfFrame
     23
     24						     ; как в коде друга: перед вертикалями		    +
     25				     гарантируем CX=ширина
     26	0114  B9 0028				     mov cx, length_of_horizontal_part_of_frame
     27
     28	0117			     print_vertical_part_of_frame:
     29	0117  83 FF 00				     cmp di, 0
     30	011A  74 35				     je	 end_of_program
     31	011C  4F				     dec di
     32	011D  46				     inc si
     33	011E  E8 003F				     call CalculateCoordinates
     34	0121  EB 01 90				     jmp one_vertical_part_of_frame
     35
     36	0124			     one_vertical_part_of_frame:
     37	0124  83 F9 28				     cmp cx, length_of_horizontal_part_of_frame
     38	0127  74 14				     je	 print_left_vertical
     39	0129  83 FF 02				     cmp di, 2
     40	012C  74 17				     je	 second_conditional
     41
     42	012E			     back3:
     43	012E  83 C3 02				     add bx, 2
     44	0131  E2 F1				     loop one_vertical_part_of_frame
     45
     46						     ; ВАЖНО: этот блок ты потерял — он ставит	    +
     47				     правую границу и переводит на след. строку
     48	0133  B9 0028				     mov cx, length_of_horizontal_part_of_frame
     49	0136  26: C7 07	0DBA			     mov es:word ptr [bx], 0DBAh	       ; рамка: bright magenta ║	on  +
     50				     black
     51	013B  EB DA				     jmp print_vertical_part_of_frame
     52
     53	013D			     print_left_vertical:
     54	013D  26: C7 07	0DBA			     mov es:word ptr [bx], 0DBAh	       ; рамка: bright magenta ║	on  +
     55				     black
     56	0142  49				     dec cx
     57	0143  EB DF				     jmp one_vertical_part_of_frame
Turbo Assembler	 Version 4.1	    02/17/26 18:54:20	    Page 2
my_frame.asm



     58
     59	0145			     second_conditional:
     60	0145  83 F9 23				     cmp cx, 35d			       ; с какого места	    +
     61				     печатать строку
     62	0148  74 02				     je	 print_string_length
     63	014A  EB E2				     jmp back3
     64
     65	014C			     print_string_length:
     66	014C  E8 001C				     call PrintString
     67	014F  EB D3				     jmp one_vertical_part_of_frame
     68
     69	0151			     end_of_program:
     70	0151  46				     inc si
     71	0152  E8 000B				     call CalculateCoordinates
     72	0155  B9 0028				     mov cx, length_of_horizontal_part_of_frame
     73	0158  E8 0035				     call PrintHorizontalPartOfFrame
     74
     75	015B  B8 4C00				     mov ax, 4C00h
     76	015E  CD 21				     int 21h
     77
     78				     ;------------------------------------------------------------------------
     79				     ; CalculateCoordinates: BX	= SI * length_of_terminal_string + x_offset
     80				     ;------------------------------------------------------------------------
     81	0160			     CalculateCoordinates proc
     82	0160  B8 00A0				     mov ax, length_of_terminal_string
     83	0163  F7 E6				     mul si
     84	0165  8B D8				     mov bx, ax
     85	0167  83 C3 28				     add bx, x_offset
     86	016A  C3				     ret
     87	016B			     CalculateCoordinates endp
     88
     89				     ;---------------------------------------------------------------------------
     90				     ; PrintString: prints command tail	from PSP (length = DS:[80h]), from DS:[82h]
     91				     ; (сохраняем “костыль”	друга: после печати делаем dec+
     92				     cx	/ add bx,2)
     93				     ; Цвет	текста: bright cyan (0Bh)
     94				     ;---------------------------------------------------------------------------
     95	016B			     PrintString proc
     96	016B  51				     push cx
     97	016C  56				     push si
     98	016D  53				     push bx
     99
    100	016E  33 C9				     xor cx, cx
    101	0170  8A 0E 0080			     mov cl, ds:[80h]
    102	0174  E3 12				     jcxz ps_done		  ; если аргументов нет —	    +
    103				     ничего не печатаем
    104
    105	0176  FE C9				     dec cl			  ; как у друга (не трогаем	    +
    106				     логику)
    107	0178  BE 0082				     mov si, 82h
    108
    109	017B			     horizontal_string:
    110	017B  8A 04				     mov al, [si]
    111	017D  B4 0B				     mov ah, 0Bh		  ; текст:	bright cyan on black
    112	017F  26: 89 07				     mov es:word ptr [bx], ax
    113	0182  83 C3 02				     add bx, 2
    114	0185  46				     inc si
Turbo Assembler	 Version 4.1	    02/17/26 18:54:20	    Page 3
my_frame.asm



    115	0186  E2 F3				     loop horizontal_string
    116
    117	0188			     ps_done:
    118	0188  5B				     pop bx
    119	0189  5E				     pop si
    120	018A  59				     pop cx
    121	018B  49				     dec cx			  ; костыль друга
    122	018C  83 C3 02				     add bx, 2			  ; костыль друга
    123	018F  C3				     ret
    124	0190			     PrintString endp
    125
    126				     ;------------------------------------------------------------------------
    127				     ; PrintHorizontalPartOfFrame: печатает верх/низ рамки
    128				     ; Цвет	рамки: bright magenta (0Dh)
    129				     ;------------------------------------------------------------------------
    130	0190			     PrintHorizontalPartOfFrame	proc
    131	0190  51				     push cx
    132
    133	0191			     horizontal_frame:
    134	0191  83 FF 05				     cmp di, 5d
    135	0194  74 08				     je	 upper_corner
    136	0196  83 FF 00				     cmp di, 0
    137	0199  74 20				     je	 bottom_corner
    138	019B  EB 3B 90				     jmp draw_hor
    139
    140	019E			     upper_corner:
    141	019E  83 F9 28				     cmp cx, length_of_horizontal_part_of_frame
    142	01A1  74 08				     je	 left_upper_corner
    143	01A3  83 F9 01				     cmp cx, 1
    144	01A6  74 0B				     je	 right_upper_corner
    145	01A8  EB 2E 90				     jmp draw_hor
    146
    147	01AB			     left_upper_corner:
    148	01AB  26: C7 07	0DC9			     mov es:word ptr [bx], 0DC9h	      ;	╔ magenta
    149	01B0  EB 2B 90				     jmp advance
    150
    151	01B3			     right_upper_corner:
    152	01B3  26: C7 07	0DBB			     mov es:word ptr [bx], 0DBBh	      ;	╗ magenta
    153	01B8  EB 23 90				     jmp advance
    154
    155	01BB			     bottom_corner:
    156	01BB  83 F9 28				     cmp cx, length_of_horizontal_part_of_frame
    157	01BE  74 08				     je	 left_bottom_corner
    158	01C0  83 F9 01				     cmp cx, 1
    159	01C3  74 0B				     je	 right_bottom_corner
    160	01C5  EB 11 90				     jmp draw_hor
    161
    162	01C8			     left_bottom_corner:
    163	01C8  26: C7 07	0DC8			     mov es:word ptr [bx], 0DC8h	      ;	╚ magenta
    164	01CD  EB 0E 90				     jmp advance
    165
    166	01D0			     right_bottom_corner:
    167	01D0  26: C7 07	0DBC			     mov es:word ptr [bx], 0DBCh	      ;	╝ magenta
    168	01D5  EB 06 90				     jmp advance
    169
    170	01D8			     draw_hor:
    171	01D8  26: C7 07	0DCD			     mov es:word ptr [bx], 0DCDh	      ;	═ magenta
Turbo Assembler	 Version 4.1	    02/17/26 18:54:20	    Page 4
my_frame.asm



    172
    173	01DD			     advance:
    174	01DD  83 C3 02				     add bx, 2
    175	01E0  E2 AF				     loop horizontal_frame
    176
    177	01E2  59				     pop cx
    178	01E3  C3				     ret
    179	01E4			     PrintHorizontalPartOfFrame	endp
    180
    181				     end start
Turbo Assembler	 Version 4.1	    02/17/26 18:54:20	    Page 5
Symbol Table




Symbol Name			  Type	 Value

??DATE				  Text	 "02/17/26"
??FILENAME			  Text	 "my_frame"
??TIME				  Text	 "18:54:20"
??VERSION			  Number 040A
@32BIT				  Text	 0
@CODE				  Text	 DGROUP
@CODESIZE			  Text	 0
@CPU				  Text	 0101H
@CURSEG				  Text	 _TEXT
@DATA				  Text	 DGROUP
@DATASIZE			  Text	 0
@FILENAME			  Text	 MY_FRAME
@INTERFACE			  Text	 000H
@MODEL				  Text	 1
@STACK				  Text	 DGROUP
@WORDSIZE			  Text	 2
ADVANCE				  Near	 DGROUP:01DD
BACK3				  Near	 DGROUP:012E
BOTTOM_CORNER			  Near	 DGROUP:01BB
CALCULATECOORDINATES		  Near	 DGROUP:0160
DRAW_HOR			  Near	 DGROUP:01D8
END_OF_PROGRAM			  Near	 DGROUP:0151
HORIZONTAL_FRAME		  Near	 DGROUP:0191
HORIZONTAL_STRING		  Near	 DGROUP:017B
LEFT_BOTTOM_CORNER		  Near	 DGROUP:01C8
LEFT_UPPER_CORNER		  Near	 DGROUP:01AB
LENGTH_OF_HORIZONTAL_PART_OF_FRA  Number 0028
ME
LENGTH_OF_TERMINAL_STRING	  Number 00A0
ONE_VERTICAL_PART_OF_FRAME	  Near	 DGROUP:0124
PRINTHORIZONTALPARTOFFRAME	  Near	 DGROUP:0190
PRINTSTRING			  Near	 DGROUP:016B
PRINT_LEFT_VERTICAL		  Near	 DGROUP:013D
PRINT_STRING_LENGTH		  Near	 DGROUP:014C
PRINT_VERTICAL_PART_OF_FRAME	  Near	 DGROUP:0117
PS_DONE				  Near	 DGROUP:0188
RIGHT_BOTTOM_CORNER		  Near	 DGROUP:01D0
RIGHT_UPPER_CORNER		  Near	 DGROUP:01B3
SECOND_CONDITIONAL		  Near	 DGROUP:0145
START				  Near	 DGROUP:0100
UPPER_CORNER			  Near	 DGROUP:019E
VIDEOSEG			  Number B800
X_OFFSET			  Number 0028

Groups & Segments		  Bit Size Align  Combine Class

DGROUP				  Group
  _DATA				  16  0000 Word	  Public  DATA
  _TEXT				  16  01E4 Word	  Public  CODE
